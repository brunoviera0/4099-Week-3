<!DOCTYPE html>
<html lang="en">
<head>
    <!-- meta tags for character encoding -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- page title -->
    <title>password validator</title>
    <script>
        //js validation from validpassword.js
        function validatePassword() {
            let password = document.forms["passwordForm"]["password"].value;

            if (password.length < 8) {
                alert("Password too short! It must be at least 8 characters.");
                return false;
            }

            const hasNumber = /\d/;
            const hasUpperCase = /[A-Z]/;
            const hasLowerCase = /[a-z]/;
            const hasSpecialChar = /[!@#$%^&*(),.?":{}|<>]/;
            const hasWhitespace = /\s/;

            if (hasWhitespace.test(password)) {
                alert("Password should not contain spaces.");
                return false;
            }

            if (!hasNumber.test(password)) {
                alert("Password should contain at least one number.");
                return false;
            }

            if (!hasUpperCase.test(password)) {
                alert("Password should contain at least one uppercase letter.");
                return false;
            }

            if (!hasLowerCase.test(password)) {
                alert("Password should contain at least one lowercase letter.");
                return false;
            }

            if (!hasSpecialChar.test(password)) {
                alert("Password should contain at least one special character.");
                return false;
            }

            return true; //submit if vlaid
        }
    </script>
</head>
<body>
    <!-- main heading-->
    <h2>enter your password</h2>
    
    <!-- display success message in green to standout -->
    {% if success %}
        <p style="color:green;">{{ success }}</p>
    {% endif %}
    
    <!-- form to input password and then submits to flask via post -->
    <form name="passwordForm" onsubmit="return validatePassword()" method="post" action="/password">
        <!-- input field for password -->
        password: <input type="password" name="password" required><br><br>
        <!-- submit the form -->
        <button type="submit">submit password</button>
    </form>
</body>
</html>
